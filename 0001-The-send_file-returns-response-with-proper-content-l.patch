From 593f1aa73b803285aee1d00617502c93221d7458 Mon Sep 17 00:00:00 2001
From: myzhan <scau.myzhan@gmail.com>
Date: Fri, 12 Jul 2019 11:25:25 +0800
Subject: [PATCH] The send_file returns response with proper content length
 now, so we need to remove it explicitly.

---
 locust/test/testcases.py | 1 +
 1 file changed, 1 insertion(+)

diff --git a/locust/test/testcases.py b/locust/test/testcases.py
index 5e997d7..88645a8 100644
--- a/locust/test/testcases.py
+++ b/locust/test/testcases.py
@@ -80,6 +80,7 @@ def no_content_length():
     r = send_file(BytesIO("This response does not have content-length in the header".encode('utf-8')),
                   add_etags=False,
                   mimetype='text/plain')
+    r.headers.remove("Content-Length")
     return r
 
 @app.errorhandler(404)
-- 
2.22.0

